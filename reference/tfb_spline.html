<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spline-based representation of functional data — tfb_spline • tidyfun</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Spline-based representation of functional data — tfb_spline"><meta property="og:description" content="Represent curves as a weighted sum of spline basis functions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidyfun</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.95</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/x01_tf_Vectors.html">tf-Vectors and Operations</a>
    </li>
    <li>
      <a href="../articles/x02_Conversion.html">Converting data to and from `tf`</a>
    </li>
    <li>
      <a href="../articles/x03_Data_Wrangling.html">Data Wrangling</a>
    </li>
    <li>
      <a href="../articles/x04_Visualization.html">Visualization</a>
    </li>
    <li>
      <a href="../articles/x05_Advice.html">Advice for Developers</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tidyfun/tidyfun/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spline-based representation of functional data</h1>
    <small class="dont-index">Source: <a href="https://github.com/tidyfun/tidyfun/blob/HEAD/R/tfb-spline.R" class="external-link"><code>R/tfb-spline.R</code></a></small>
    <div class="hidden name"><code>tfb_spline.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Represent curves as a weighted sum of spline basis functions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">tfb_spline</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for data.frame</span>
<span class="fu">tfb_spline</span><span class="op">(</span>
  <span class="va">data</span>,
  id <span class="op">=</span> <span class="fl">1</span>,
  arg <span class="op">=</span> <span class="fl">2</span>,
  value <span class="op">=</span> <span class="fl">3</span>,
  domain <span class="op">=</span> <span class="cn">NULL</span>,
  penalized <span class="op">=</span> <span class="cn">TRUE</span>,
  global <span class="op">=</span> <span class="cn">FALSE</span>,
  resolution <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for matrix</span>
<span class="fu">tfb_spline</span><span class="op">(</span>
  <span class="va">data</span>,
  arg <span class="op">=</span> <span class="cn">NULL</span>,
  domain <span class="op">=</span> <span class="cn">NULL</span>,
  penalized <span class="op">=</span> <span class="cn">TRUE</span>,
  global <span class="op">=</span> <span class="cn">FALSE</span>,
  resolution <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for numeric</span>
<span class="fu">tfb_spline</span><span class="op">(</span>
  <span class="va">data</span>,
  arg <span class="op">=</span> <span class="cn">NULL</span>,
  domain <span class="op">=</span> <span class="cn">NULL</span>,
  penalized <span class="op">=</span> <span class="cn">TRUE</span>,
  global <span class="op">=</span> <span class="cn">FALSE</span>,
  resolution <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for list</span>
<span class="fu">tfb_spline</span><span class="op">(</span>
  <span class="va">data</span>,
  arg <span class="op">=</span> <span class="cn">NULL</span>,
  domain <span class="op">=</span> <span class="cn">NULL</span>,
  penalized <span class="op">=</span> <span class="cn">TRUE</span>,
  global <span class="op">=</span> <span class="cn">FALSE</span>,
  resolution <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for tfd</span>
<span class="fu">tfb_spline</span><span class="op">(</span>
  <span class="va">data</span>,
  arg <span class="op">=</span> <span class="cn">NULL</span>,
  domain <span class="op">=</span> <span class="cn">NULL</span>,
  penalized <span class="op">=</span> <span class="cn">TRUE</span>,
  global <span class="op">=</span> <span class="cn">FALSE</span>,
  resolution <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for tfb</span>
<span class="fu">tfb_spline</span><span class="op">(</span>
  <span class="va">data</span>,
  arg <span class="op">=</span> <span class="cn">NULL</span>,
  domain <span class="op">=</span> <span class="cn">NULL</span>,
  penalized <span class="op">=</span> <span class="cn">TRUE</span>,
  global <span class="op">=</span> <span class="cn">FALSE</span>,
  resolution <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">tfb_spline</span><span class="op">(</span>
  <span class="va">data</span>,
  arg <span class="op">=</span> <span class="cn">NULL</span>,
  domain <span class="op">=</span> <span class="cn">NULL</span>,
  penalized <span class="op">=</span> <span class="cn">TRUE</span>,
  global <span class="op">=</span> <span class="cn">FALSE</span>,
  resolution <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>a <code>matrix</code>, <code>data.frame</code> or <code>list</code> of suitable shape, or another
<code>tf</code>-object containing functional data.</p></dd>
<dt>...</dt>
<dd><p>arguments to the calls to <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">mgcv::s()</a></code> setting up the basis and
<code><a href="https://rdrr.io/pkg/mgcv/man/magic.html" class="external-link">mgcv::magic()</a></code> or <code><a href="https://rdrr.io/pkg/mgcv/man/gam.fit.html" class="external-link">mgcv::gam.fit()</a></code> (if <code>penalized</code> is TRUE). If not user-specified here,
<code>tidyfun</code> uses <code>k = 25</code> cubic regression spline basis functions
(i.e., <code>bs = "cr"</code>) by default, but this should (!) be set appropriately.</p></dd>
<dt>id</dt>
<dd><p>The name or number of the column defining which data belong to which function.</p></dd>
<dt>arg</dt>
<dd><p>a grid of argument values to evaluate on</p></dd>
<dt>value</dt>
<dd><p>The name or number of the column containing the function evaluations.</p></dd>
<dt>domain</dt>
<dd><p>range of the <code>arg</code>.</p></dd>
<dt>penalized</dt>
<dd><p>should the coefficients of the basis representation be estimated
via <code><a href="https://rdrr.io/pkg/mgcv/man/magic.html" class="external-link">mgcv::magic()</a></code> (default) or ordinary least squares.</p></dd>
<dt>global</dt>
<dd><p>Defaults to <code>FALSE</code>.
If <code>TRUE</code> and <code>penalized = TRUE</code>, all functions share the same smoothing
parameter (see Details).</p></dd>
<dt>resolution</dt>
<dd><p>resolution of the evaluation grid. See details for <code><a href="tfd.html">tfd()</a></code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a <code>tfb</code>-object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The basis to be used is set up via a call to <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">mgcv::s()</a></code> and all the spline bases
discussed in <code><a href="https://rdrr.io/pkg/mgcv/man/smooth.terms.html" class="external-link">mgcv::smooth.terms()</a></code> are available, in principle. Depending on
the value of the <code>penalized</code>- and <code>global</code>-flags, the coefficient vectors for each
observation are then estimated via fitting a GAM
(separately for each observation, if <code>!global</code>)
via <code><a href="https://rdrr.io/pkg/mgcv/man/magic.html" class="external-link">mgcv::magic()</a></code> (least square error, the default)
or <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam()</a></code> (if a <code>family</code> argument was supplied) or
unpenalized least squares / maximum likelihood.</p>
<p>After the "smoothed" representation is computed, the amount of smoothing that
was performed is reported in terms of the "percentage of variability preserved",
which is the variance (explained deviance, in the general case) of the smoothed function values divided by the variance
of the original values (null deviance, in the general case).
Reporting can be switched off with <code>verbose = FALSE</code>.</p>
<p>The <code>...</code> arguments supplies arguments to both the
spline basis (via <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">mgcv::s()</a></code>) and the estimation (via
<code><a href="https://rdrr.io/pkg/mgcv/man/magic.html" class="external-link">mgcv::magic()</a></code> or <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam()</a></code>), most important:</p><ul><li><p>how many basis functions <code>k</code> the spline basis should have, the default is</p></li>
</ul><ol><li><p></p></li>
</ol><ul><li><p>which type of spline basis <code>bs</code> should be used, the default is cubic
regression splines (<code>"cr"</code>) - a <code>family</code>-argument to the fitters for data for
which squared errors are not a reasonable criterion for the representation
accuracy (see <code><a href="https://rdrr.io/pkg/mgcv/man/family.mgcv.html" class="external-link">mgcv::family.mgcv()</a></code> for what's available).</p></li>
<li><p>an <code>sp</code>-argument for manually fixing the amount of smoothing (see
<code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">mgcv::s()</a></code>), which (drastically) reduces the computation time.</p></li>
</ul><p>If <strong><code>global == TRUE</code></strong>, the routine first takes a subset of curves (10\<!-- % of -->
curves sampled deterministically, at most 100, at least 5) on which smoothing
parameters per curve are estimated and then uses the mean of the log
smoothing parameter of those for all curves. This can be much faster than
optimizing the smoothing parameter for each curve on large datasets. For very
sparse data, it would be preferable to estimate a joint smoothing parameter
directly for all curves, this is <em>not</em> what's implemented here.</p>
    </div>
    <div id="methods-by-class-">
    <h2>Methods (by class)</h2>
    
<ul><li><p><code>data.frame</code>: convert data frames</p></li>
<li><p><code>matrix</code>: convert matrices</p></li>
<li><p><code>numeric</code>: convert matrices</p></li>
<li><p><code>list</code>: convert lists</p></li>
<li><p><code>tfd</code>: convert <code>tfd</code> (raw functional data)</p></li>
<li><p><code>tfb</code>: convert <code>tfb</code>: modify basis representation, smoothing.</p></li>
<li><p><code>default</code>: convert <code>tfb</code>: default method, returning prototype when data is missing</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/mgcv/man/smooth.terms.html" class="external-link">mgcv::smooth.terms()</a></code> for spline basis options.</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Fabian Scheipl, Jeff Goldsmith, Julia Wrobel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

